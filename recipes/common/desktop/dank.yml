# Dank Linux.
modules:
  - type: files
    files:
      - source: dank
        destination: /

  - type: dnf
    repos:
      copr:
        - yalter/niri
        - solopasha/hyprland
        - avengemedia/danklinux
        - avengemedia/dms

    install:
      packages:
        # Basic utils
        - brightnessctl
        - cava
        - wl-clipboard
        - gammastep
        - sassc
        - libappstream-glib
        - gnome-keyring

        # Theming!
        - adw-gtk3-theme
        - nwg-look
        - qt6-qtmultimedia
        - qt6ct
        - qt5ct

        # XDG Desktop Portals. Nautilus is required for filepicker on xdg-desktop-portal-gnome
        - xdg-desktop-portal-gnome
        - xdg-desktop-portal-gtk
        - nautilus

        # Wayland compositors and their specific tools
        - niri
        - hyprland
        - hyprland-devel
        - xdg-desktop-portal-hyprland
        - grimblast
        - matugen

        # DankMaterialShell
        - cliphist
        - dms
        - dms-cli
        - dms-greeter
        - danksearch
        - quickshell-git
        - dgop

        # File Manager
        - dolphin
        - plasma-workspace
        - ark
      exclude:
        - alacritty
        - mako
        - swaybg
        - swayidle
        - swaylock
        - swaylock-effects
        - waybar
        - waybar-git
        - wofi
        - xwaylandvideobridge

  - type: script
    snippets:
      - "rm /usr/share/wayland-sessions/plasma.desktop" # only needed because dolphin requires plasma-workspace to work properly, and that adds the plasma.desktop session.

  - type: systemd
    system:
      enabled:
        - greetd.service
        - dms-greeter-folder-create.service
    user:
      enabled:
        - gnome-keyring-daemon.socket
        - gnome-keyring-daemon.service
        - dsearch.service

  # rebuild initramfs for the plymouth watermark to apply properly
  - type: initramfs
